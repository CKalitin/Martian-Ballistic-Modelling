import sim
import numpy as np

# Pheonix Entry:
pheonix = [
    # Velocity (m/s)
    np.array([
    5873, 5884, 5895, 5895, 5884, 5861, 5828, 5773, 5706, 5573, 5452, 5330,
    5075, 4787, 4488, 4199, 3934, 3335, 2659, 2183, 1850, 1496, 1263, 1030,
    765, 654, 554, 476, 410, 355, 299, 199, 122, 78, 66, 55, 0
    ]),
    # Altitude (m)
    np.array([
    123545, 104182, 93273, 73909, 70091, 64909, 60273, 56182, 52909, 49091,
    46909, 45000, 42273, 39818, 38182, 36545, 35182, 32455, 30000, 28091,
    26727, 25091, 23727, 22091, 19636, 18273, 16636, 15273, 13636, 12000,
    9818, 9273, 8727, 7636, 5727, 1364, 0
    ]),
    "Pheonix"
]

# MER Entry:
mer = [
    # Velocity (m/s)
    np.array([
    5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5548, 5537, 5537, 5537, 5537, 5537, 5537, 5537, 5537, 5537, 5526, 5503, 5481, 5459, 5415, 5370, 5337, 5315, 5315, 5237, 5237, 5160, 5160, 5082, 5082, 5004, 5004, 4926, 4926, 4849, 4849, 4760, 4760, 4671, 4671, 4583, 4583, 4505, 4505, 4416, 4416, 4327, 4327, 4239, 4239, 4150, 4150, 4061, 4061, 3961, 3961, 3872, 3872, 3784, 3784, 3695, 3695, 3595, 3595, 3506, 3506, 3417, 3417, 3318, 3318, 3229, 3229, 2752, 2752, 2663, 2663, 2574, 2574, 2474, 2474, 2386, 2386, 2297, 2297, 2208, 2208, 2108, 2108, 2019, 2019, 1931, 1931, 1842, 1842, 1753, 1753, 1664, 1664, 1564, 1564, 1487, 1487, 1398, 1398, 1309, 1309, 1221, 1221, 1132, 1132, 1043, 1043, 965, 965, 877, 877, 799, 799, 721, 721, 644, 644, 566, 566, 499, 499, 422, 422, 333, 333, 100, 67, 44
    ]),
    # Altitude (m)
    np.array([
    105738, 79508, 80055, 108197, 75410, 103279, 101093, 98634, 79508, 96175, 91530, 89071, 86885, 84426, 72951, 93989, 80055, 70492, 68033, 123770, 112842, 110383, 116667, 118852, 121311, 115027, 65574, 63115, 60929, 58743, 56557, 54372, 52732, 52459, 52459, 50273, 50273, 48634, 48634, 47268, 47268, 45902, 45902, 44809, 44809, 43989, 43989, 42896, 42896, 42077, 42077, 41257, 41257, 40710, 40710, 39891, 39891, 39071, 39071, 38525, 38525, 37705, 37705, 37158, 37158, 36612, 36612, 36066, 36066, 35519, 35519, 35246, 35246, 34699, 34699, 34153, 34153, 33607, 33607, 33060, 33060, 32787, 32787, 30055, 30055, 29508, 29508, 29235, 29235, 28962, 28962, 28415, 28415, 28142, 28142, 27596, 27596, 27322, 27322, 26776, 26776, 26230, 26230, 25683, 25683, 25137, 25137, 24863, 24863, 24317, 24317, 23770, 23770, 22951, 22951, 22404, 22404, 21858, 21858, 21038, 21038, 20219, 20219, 19399, 19399, 18579, 18579, 17486, 17486, 16667, 16667, 15301, 15301, 13934, 13934, 12295, 12295, 10656, 10656, 10109, 10109, 7923, 4372, 546
    ]),
    "MER"
]


# Curiosity
sim_data = sim.simulate(
    time_step=0.01,
    time_max=1000,
    mass=3300,
    area=15.9,
    entry_altitude=125000,
    entry_flight_path_angle=-14,
    entry_velocity=5800,
    verbose=False,
)
sim.plot(sim_data, filename="backtest/Curiosity-Entry.png", comparisons=[pheonix, mer])